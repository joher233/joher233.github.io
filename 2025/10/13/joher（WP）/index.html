
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title> | Hexo</title>
    <meta name="author" content="John Doe" />
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta
        name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"
    />
    <link rel="icon" href="/images/avatar.jpg" />
    <link rel="preconnect" href="https://s4.zstatic.net" />
<script src="https://s4.zstatic.net/ajax/libs/vue/3.3.7/vue.global.prod.min.js"></script>
<link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
<link rel="preconnect" href="https://fonts.googleapis.cn" />
<link rel="preconnect" href="https://fonts.gstatic.cn" crossorigin />
<link
    rel="stylesheet"
    href="https://fonts.googleapis.cn/css2?family=Fira+Code:wght@400;500;600;700&family=Lexend:wght@400;500;600;700;800;900&family=Noto+Sans+SC:wght@400;500;600;700;800;900&display=swap"
/>
<script> const mixins = {}; </script>

<script src="https://polyfill.alicdn.com/v3/polyfill.min.js?features=default"></script>


<script src="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://s4.zstatic.net/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
<link
    rel="stylesheet"
    href="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/styles/github.min.css"
/>
<script src="/js/lib/highlight.js"></script>



<script src="/js/lib/preview.js"></script>









<link rel="stylesheet" href="/css/main.css" />

<meta name="generator" content="Hexo 7.3.0"></head>
<body>
    <div id="layout">
        <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>加载过慢请开启缓存 浏览器默认开启</p>
                    <img src="/images/loading.gif" />
                </div>
            </div>
        </transition>
        <div id="menu" :class="{ hidden: hiddenMenu, 'menu-color': menuColor}">
    <nav id="desktop-menu">
        <a class="title" href="/">
            <span>HEXO</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
    </nav>
    <nav id="mobile-menu">
        <div class="title" @click="showMenuItems = !showMenuItems">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;HEXO</span>
        </div>
        <transition name="slide">
            <div class="items" v-show="showMenuItems">
                
                <a href="/">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-house fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                    </div>
                </a>
                
                <a href="/about">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-id-card fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                    </div>
                </a>
                
                <a href="/archives">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-box-archive fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                    </div>
                </a>
                
                <a href="/categories">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-bookmark fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                    </div>
                </a>
                
                <a href="/tags">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-tags fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                    </div>
                </a>
                
            </div>
        </transition>
    </nav>
</div>
<transition name="fade">
    <div id="menu-curtain" @click="showMenuItems = !showMenuItems" v-show="showMenuItems"></div>
</transition>

        <div id="main" :class="loading ? 'into-enter-from': 'into-enter-active'">
            <div class="article">
    <div>
        <h1></h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2025/10/13
        </span>
        
        
    </div>
    
    <div class="content" v-pre>
        <h1 id="joher（WP）"><a href="#joher（WP）" class="headerlink" title="joher（WP）"></a>joher（WP）</h1><h2 id="Crypto-Cantor’s-gifts"><a href="#Crypto-Cantor’s-gifts" class="headerlink" title="Crypto-Cantor’s gifts"></a>Crypto-Cantor’s gifts</h2><p>这道题主要通过now message反推原始message，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">now_message = <span class="string">b&#x27;&#x27;</span>.join(message[i - <span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> reflection)</span><br></pre></td></tr></table></figure>

<p>这段代码说明now_message是message对照reflection的重新排序，所有需要reflection，也就是通过hint和calculate相反函数逆推。</p>
<p>搜索后发现calculate函数是一种编码方式，lehmer码，<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20251013142603387.png" alt="image-20251013142603387">附上文章链接<a target="_blank" rel="noopener" href="https://ryderfang.com/leetcode/lehmer_code/">中介数 · 一个技术宅的碎碎念</a><br>由文章知使用 序号-&gt;中介数-&gt;排列（原理让人头大。。。)</p>
<p>解出原始reflection后需要求它的逆排序以恢复message，代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">hint = <span class="number">2498752981111460725490082182453813672840574</span></span><br><span class="line">hint2 = <span class="string">b&#x27;5__r0tfg5f_34rtm__t_0ury0hft0t3n11c_t&#x27;</span></span><br><span class="line">sz = <span class="built_in">len</span>(hint2)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index_to_order</span>(<span class="params">index, sz</span>):</span><br><span class="line">    L = [<span class="number">0</span>] * sz</span><br><span class="line">    tmp = index</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(sz - <span class="number">2</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        divisor = sz - i</span><br><span class="line">        L[i] = tmp % divisor</span><br><span class="line">        tmp = tmp // divisor</span><br><span class="line"></span><br><span class="line">    nums = [x + <span class="number">1</span> <span class="keyword">for</span> x <span class="keyword">in</span> L]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 外层循环：stride(from: sz-1, to: 0, by: -1)</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(sz - <span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">        <span class="comment"># 内层循环：stride(from: i - 1, to: -1, by: -1)</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i - <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> nums[j] &lt;= nums[i]:</span><br><span class="line">                nums[i] += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> nums</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inverse_order</span>(<span class="params">reflection</span>):</span><br><span class="line">    n = <span class="built_in">len</span>(reflection)</span><br><span class="line">    inverse = [<span class="number">0</span>] * n</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        inverse[reflection[i] - <span class="number">1</span>] = i + <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> inverse</span><br><span class="line"></span><br><span class="line">reflection = index_to_order(hint, sz)</span><br><span class="line"> <span class="comment">#计算逆排列以回复message</span></span><br><span class="line">inv_reflection = inverse_order(reflection)</span><br><span class="line"><span class="comment"># 将整数转换回字节</span></span><br><span class="line">original_message = <span class="string">b&#x27;&#x27;</span>.join([<span class="built_in">bytes</span>([hint2[i - <span class="number">1</span>]]) <span class="keyword">for</span> i <span class="keyword">in</span> inv_reflection])</span><br><span class="line"><span class="built_in">print</span>(original_message)</span><br></pre></td></tr></table></figure>

<p>最后flag为<em>TSCTF-J{c4nt0r5_g1ft_f0r_th3_f1r5t_y0u_t0_m3t}</em></p>
<h2 id="Crypto-Sign-in"><a href="#Crypto-Sign-in" class="headerlink" title="Crypto-Sign in"></a>Crypto-Sign in</h2><p>签到题，k1已知，根据k1^（k2^k1)结果出k2，再用k2^(k2^k3)出k3，最后用k123^(flag^k123)解出flag转字节，代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">K1_hex = <span class="string">&quot;a6c8b6733c9b22de7bc0253266a3867df55acde8635e19c73313c1819383df93&quot;</span></span><br><span class="line">K12_hex = <span class="string">&quot;b38dc315bb7c75e3c9fa84f123898ff684fd36189e83c422cf0d2804c12b4c83&quot;</span></span><br><span class="line">K23_hex = <span class="string">&quot;11abed33a76d7be822ab718422844e1d40d72a96f02a288aa3b168165922138f&quot;</span></span><br><span class="line">K0_hex = <span class="string">&quot;e1251504cdb300420a0520fc1c15b010d4bfb118c2477b78f3eafbe1acf0f121&quot;</span></span><br><span class="line"></span><br><span class="line">K1 = <span class="built_in">int</span>(K1_hex, <span class="number">16</span>)</span><br><span class="line">K12 = <span class="built_in">int</span>(K12_hex, <span class="number">16</span>)</span><br><span class="line">K23 = <span class="built_in">int</span>(K23_hex, <span class="number">16</span>)</span><br><span class="line">K0 = <span class="built_in">int</span>(K0_hex, <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">K2 = K1 ^ K12</span><br><span class="line">K3 = K2 ^ K23</span><br><span class="line">K123 = K1 ^ K2 ^ K3</span><br><span class="line">m = K0 ^ K123</span><br><span class="line"></span><br><span class="line">hex_m = <span class="built_in">hex</span>(m)[<span class="number">2</span>:]  <span class="comment"># 去除前缀</span></span><br><span class="line"></span><br><span class="line">bytes_m = <span class="built_in">bytes</span>.fromhex(hex_m)</span><br><span class="line">flag = base64.b64decode(bytes_m).decode()</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>注意：十六进制不能直接异或。</p>
<p>flag：<em>TSCTF-J{I_like_Crypto}</em></p>
<h2 id="Crypto-p-q"><a href="#Crypto-p-q" class="headerlink" title="Crypto-p&#x3D;~q"></a>Crypto-p&#x3D;~q</h2><p>RSA，第一眼n太长放弃分解，寻找p,q关系，这里要用到按位取反（题目中提示~），观察p,q的二进制结构，p&#x3D;1 B 1，q&#x3D;1 ~B 1，则p+q按二进制计算就为3*2**1023，则n的欧拉函数为(p-1)(q-1)&#x3D;n-(p+q)+1，可解，代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>  long_to_bytes</span><br><span class="line"></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">n = <span class="number">17051407421191257766878232954687995776275810092183184400406052880776283989210979642731778073370935322411364098277851627904479300390445258684605069414401583042318910193017463817007183769745191345053634189302047446965986220310713141272104307300803560476507359063543147558286276881771260972717080160544078251002420560031692800880310702557545555020333582797788637377901506395695115351043959528307703535156759957098992921231240480724115372547821536358993064005667175508572424424498140029596238691489470392031290179060300593482514446687661068760457021164559923920591924277937814270216802997593891640228684835585559706493543</span></span><br><span class="line">c = <span class="number">6853848340403815994585475502319517119889957571722212403728096345969080424626781659085329098693249503884838912886399198433606071464349852827030377680456139046436386063565577131001152891176064224036780277315958771309063181054101040906120879494157473100295607616604515810676954786850526056316144848921849017030095717895244910724234927693999607754055953250981051858498499963202512464388765761597435963200846457903991924487952495202449073962133164877330289865956477568456497103568127103331224273528931042804794039714404647322385366048042459109584024130199496106946124782839099804356052016687352504438568019898976023369460</span></span><br><span class="line">x=<span class="number">2</span>**<span class="number">1023</span></span><br><span class="line">k=<span class="number">3</span>*x</span><br><span class="line">fn=n+<span class="number">1</span>-k</span><br><span class="line">d=invert(e,fn)</span><br><span class="line">k=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(k)</span><br><span class="line">flag=long_to_bytes(k).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>解出flag：<em>TSCTF-J{The_easiest_RSA_key!}</em></p>
<h2 id="Crypto-野狐禅"><a href="#Crypto-野狐禅" class="headerlink" title="Crypto-野狐禅"></a>Crypto-野狐禅</h2><p>主要应用paillier加密，LCG辅助生成随机数。</p>
<p>观察代码中y的结构，前半部分为0，1，2随机排列，后半部分由flag的三进制数列coeffs一一对照乘y中倒数75个元素再相加得到。</p>
<p>再看y的用处，用y中的元素和LCG生成的随机数加密得到密文，而密文和raw都是已知，这就说明可以解出y。</p>
<p>附一张原理图片<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20251013173223028.png" alt="image-20251013173223028"></p>
<p>部分代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> GCD, inverse</span><br><span class="line"><span class="comment">#读取数据是AI生成的，读取文件不会捏</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_challenge</span>():</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;challenge.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        lines = [line.strip() <span class="keyword">for</span> line <span class="keyword">in</span> f <span class="keyword">if</span> line.strip()]</span><br><span class="line">    n = <span class="built_in">int</span>(lines[<span class="number">0</span>].split(<span class="string">&quot;: &quot;</span>)[<span class="number">1</span>])</span><br><span class="line">    g = <span class="built_in">int</span>(lines[<span class="number">1</span>].split(<span class="string">&quot;: &quot;</span>)[<span class="number">1</span>])</span><br><span class="line">    k = <span class="built_in">int</span>(lines[<span class="number">2</span>].split(<span class="string">&quot;: &quot;</span>)[<span class="number">1</span>])</span><br><span class="line">    eqs = <span class="built_in">int</span>(lines[<span class="number">3</span>].split(<span class="string">&quot;: &quot;</span>)[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 解析密文（共2k个）</span></span><br><span class="line">    ciphertexts = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>, lines[<span class="number">4</span>:<span class="number">4</span> + <span class="number">2</span> * k]))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 解析LCG的raw值（与密文一一对应）</span></span><br><span class="line">    lcg_raws = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>, lines[<span class="number">4</span> + <span class="number">2</span> * k:<span class="number">4</span> + <span class="number">4</span> * k]))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> n, g, k, eqs, ciphertexts, lcg_raws</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密y</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_y</span>(<span class="params">c, raw, n</span>):</span><br><span class="line">    n2 = n * n</span><br><span class="line">    r = raw % n</span><br><span class="line">    r_pow_n = <span class="built_in">pow</span>(r, n, n2)</span><br><span class="line">    r_inv = inverse(r_pow_n, n2)</span><br><span class="line">    <span class="comment"># (c * r_inv) mod n² = (g^m) mod n² = 1 + m*n mod n²</span></span><br><span class="line">    g_m = (c * r_inv) % n2</span><br><span class="line">    m = (g_m - <span class="number">1</span>) // n</span><br><span class="line">    <span class="keyword">return</span> m % n</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    n, g, k, eqs, ciphertexts, lcg_raws = read_challenge()</span><br><span class="line"></span><br><span class="line">    y = []</span><br><span class="line">    <span class="keyword">for</span> c, raw <span class="keyword">in</span> <span class="built_in">zip</span>(ciphertexts, lcg_raws):</span><br><span class="line">        m = decrypt_y(c, raw, n)</span><br><span class="line">        y.append(m)</span><br><span class="line">    <span class="keyword">return</span> y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    y = main()</span><br><span class="line">    <span class="built_in">print</span>(y)</span><br></pre></td></tr></table></figure>

<p>这样可以解出y&#x3D;[2, 0, 2, 2, 0, 0, 2, 0, 0, 0, 2, 2, 0, 2, 2, 2, 1, 2, 0, 1, 2, 1, 2, 0, 2, 0, 0, 1, 0, 0, 0, 0, 2, 0, 2, 0, 1, 0, 0, 2, 1, 0, 0, 0, 1, 2, 0, 1, 1, 2, 1, 2, 2, 2, 0, 2, 1, 0, 2, 2, 0, 0, 1, 0, 2, 2, 1, 2, 1, 2, 2, 1, 1, 2, 2, 85, 247, 658, 1808, 4930, 13390, 36300, 98395, 266679, 722907, 1959621, 5311924, 14399106, 39031939, 105804512, 286806153, 777450430, 2107448402, 5712697045, 15485507335, 41976834189, 113787334890, 308445309056, 836108067143, 2266452688571, 6143712746597, 16653869062761, 45143932699981, 122372444021419, 331717113687850, 899191353031636, 2437453649520883, 6607248027387804, 17910382215473062, 48549984770461261, 131605288645134369, 356744746290979408, 967034192291334054, 2621356414588350488, 7105756453163078134, 19261697680892355460, 52213019119863035142, 141534739604784595474, 383660681812086893155, 1039995687133333475542, 2819134408424178198140, 7641876703035041713849, 20714968172458587241936, 56152424732990956319774, 152213354958777359281615, 412607390294838678976398, 1118462033584525446279863, 3031834499319389428921467, 8218446541098960707752653, 22277886066691317092646277, 60389053468748842925108077, 163697658203933453439408415, 443738090965760048784977365, 1202848565668765266412838998, 3260582540440613412693349716, 8838517837127128854153539487, 23958724120094774432776541926, 64945330432165614006735655355, 176048437462724627283096336079, 477217563246346469686917985472, 1293601953831599260131820258924, 3506589329138112969778357788101, 9505372720568720609653808621757, 25766379258086577601960126466087, 69845372673806283978117218535567, 189331067243832685846390246443453, 513223018955011063107993542622247, 1391202569233262631762630050334516, 3771157015875960254174114262743405, 10222540953348355076583956442613074]</p>
<p>接下来要在sagemath里运行<br>（线性齐次递归关系求解）附上文章链接<a target="_blank" rel="noopener" href="https://blog.csdn.net/wangshuqi666/article/details/143101007">【ShuQiHere】线性齐次递归关系解法模板全面指南 ✨_求解线性齐次递归方程-CSDN博客</a></p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#在sagemath里运行</span></span><br><span class="line">y = [<span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">85</span>, <span class="number">247</span>, <span class="number">658</span>, <span class="number">1808</span>, <span class="number">4930</span>, <span class="number">13390</span>, <span class="number">36300</span>, <span class="number">98395</span>, <span class="number">266679</span>, <span class="number">722907</span>, <span class="number">1959621</span>, <span class="number">5311924</span>, <span class="number">14399106</span>, <span class="number">39031939</span>, <span class="number">105804512</span>, <span class="number">286806153</span>, <span class="number">777450430</span>, <span class="number">2107448402</span>, <span class="number">5712697045</span>, <span class="number">15485507335</span>, <span class="number">41976834189</span>, <span class="number">113787334890</span>, <span class="number">308445309056</span>, <span class="number">836108067143</span>, <span class="number">2266452688571</span>, <span class="number">6143712746597</span>, <span class="number">16653869062761</span>, <span class="number">45143932699981</span>, <span class="number">122372444021419</span>, <span class="number">331717113687850</span>, <span class="number">899191353031636</span>, <span class="number">2437453649520883</span>, <span class="number">6607248027387804</span>, <span class="number">17910382215473062</span>, <span class="number">48549984770461261</span>, <span class="number">131605288645134369</span>, <span class="number">356744746290979408</span>, <span class="number">967034192291334054</span>, <span class="number">2621356414588350488</span>, <span class="number">7105756453163078134</span>, <span class="number">19261697680892355460</span>, <span class="number">52213019119863035142</span>, <span class="number">141534739604784595474</span>, <span class="number">383660681812086893155</span>, <span class="number">1039995687133333475542</span>, <span class="number">2819134408424178198140</span>, <span class="number">7641876703035041713849</span>, <span class="number">20714968172458587241936</span>, <span class="number">56152424732990956319774</span>, <span class="number">152213354958777359281615</span>, <span class="number">412607390294838678976398</span>, <span class="number">1118462033584525446279863</span>, <span class="number">3031834499319389428921467</span>, <span class="number">8218446541098960707752653</span>, <span class="number">22277886066691317092646277</span>, <span class="number">60389053468748842925108077</span>, <span class="number">163697658203933453439408415</span>, <span class="number">443738090965760048784977365</span>, <span class="number">1202848565668765266412838998</span>, <span class="number">3260582540440613412693349716</span>, <span class="number">8838517837127128854153539487</span>, <span class="number">23958724120094774432776541926</span>, <span class="number">64945330432165614006735655355</span>, <span class="number">176048437462724627283096336079</span>, <span class="number">477217563246346469686917985472</span>, <span class="number">1293601953831599260131820258924</span>, <span class="number">3506589329138112969778357788101</span>, <span class="number">9505372720568720609653808621757</span>, <span class="number">25766379258086577601960126466087</span>, <span class="number">69845372673806283978117218535567</span>, <span class="number">189331067243832685846390246443453</span>, <span class="number">513223018955011063107993542622247</span>, <span class="number">1391202569233262631762630050334516</span>, <span class="number">3771157015875960254174114262743405</span>, <span class="number">10222540953348355076583956442613074</span>]</span><br><span class="line">k=<span class="number">75</span></span><br><span class="line">eqs=<span class="number">75</span></span><br><span class="line"><span class="comment"># 构建线性方程组：Acoeffs = y[k:2k]    A[i][j] = y[i + k - 1 - j]</span></span><br><span class="line">b = vector(ZZ, y[k: <span class="number">2</span>*k])</span><br><span class="line">A = matrix(ZZ, k, k)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">        idx = i + k - <span class="number">1</span> - j</span><br><span class="line">        A[i, j] = y[idx]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 求解线性方程组 (需要A是可逆矩阵）</span></span><br><span class="line">coeffs = A.solve_right(b)</span><br><span class="line">coeffs = [<span class="built_in">int</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> coeffs]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">coeffs_to_flag</span>(<span class="params">coeffs</span>):</span><br><span class="line">    <span class="comment">#3进制转整数</span></span><br><span class="line">    num = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> power, c <span class="keyword">in</span> <span class="built_in">enumerate</span>(coeffs):</span><br><span class="line">        num += c * (<span class="number">3</span> ** power)</span><br><span class="line">    <span class="comment"># 整数转字节串</span></span><br><span class="line">    flag = <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(num)[<span class="number">2</span>:])</span><br><span class="line">    <span class="keyword">return</span> flag.decode(<span class="string">&quot;utf-8&quot;</span>, errors=<span class="string">&quot;ignore&quot;</span>)</span><br><span class="line">flag = coeffs_to_flag(coeffs)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>输出We_sh0u1d_kn0w!，则flag：<em>TSCTF-J{We_sh0u1d_kn0w!}</em></p>
<h2 id="Crypto-Microsoft’s-gifts"><a href="#Crypto-Microsoft’s-gifts" class="headerlink" title="Crypto-Microsoft’s gifts"></a>Crypto-Microsoft’s gifts</h2><p>构造的椭圆曲线为Secp256k1，大致意思为程序给出公钥，我需要自己提供曲线y² ≡ x³ + ax + b (mod p) 的参数p,a,b，再给出一个在该曲线上的点 G’的横纵坐标，提供密钥k&gt;1，将密钥与G’进行 multiply操作，得出结果与公钥相等。</p>
<p>要进行大量的计算，感觉有两个思路，先给p,a,b再推k，和先给k再推p,a,b，我打算先给出p,a,b再推k。</p>
<p>使用建议参数![](C:\Users\Lenovo\Pictures\Screenshots\屏幕截图 2025-10-13 175912.png)</p>
<p>发现b并不能符合，所有只能知道p,a，b还需要再推，通过方程y² ≡ x³ + ax + b (mod p) 和公钥，推出b&#x3D;(pow(py_mod, 2, p) - pow(px_mod, 3, p) - a * px_mod) % p，后来发现key好像没法推出来，只好从小到大验证，还好在key&#x3D;3时推出来了。</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 公钥参数</span></span><br><span class="line">px = <span class="number">0xb87fc6d7cecd3d79937f2577a1578f5ba4481208df5d9a549c9df452560a2be8</span></span><br><span class="line">py = <span class="number">0xd8e22bf9bcfebb38098297f81df04725f27bddd224793ac7e8820b4b94f643e8</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F</span></span><br><span class="line">a = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算b</span></span><br><span class="line">b = (<span class="built_in">pow</span>(py, <span class="number">2</span>, p) - <span class="built_in">pow</span>(px, <span class="number">3</span>, p) - a * px) % p</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建椭圆曲线</span></span><br><span class="line">F = GF(p)</span><br><span class="line">E = EllipticCurve(F, [a, b])</span><br><span class="line"></span><br><span class="line"><span class="comment">#  在新曲线上找到公钥点</span></span><br><span class="line">P = E(px, py)</span><br><span class="line"></span><br><span class="line">key = <span class="number">3</span></span><br><span class="line"><span class="comment"># 计算生成点G</span></span><br><span class="line">G = P * key_inv</span><br><span class="line"></span><br><span class="line"><span class="comment"># 算公钥验证</span></span><br><span class="line">l = key * G</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出参数</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[p, a, b]:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;p&#125;</span>, <span class="subst">&#123;a&#125;</span>, <span class="subst">&#123;b&#125;</span>]&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n[gx, gy]:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">int</span>(G[<span class="number">0</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">int</span>(G[<span class="number">1</span>])&#125;</span>]&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nkey:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n公钥结果:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;key * G = <span class="subst">&#123;l&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;是否等于公钥: <span class="subst">&#123;l == P&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>在sagemath运行，输出flag：<em>TSCTF-J{Microsoft-CVE-2020-0601}</em></p>
<h2 id="Crypto-玲珑格"><a href="#Crypto-玲珑格" class="headerlink" title="Crypto-玲珑格"></a>Crypto-玲珑格</h2><p>最阴的来了（</p>
<p>开始需要解一个背包问题，但是这个背包不是超递增数列，只能使用LLL或者BKZ解密。（中间相遇算法时间太长，做不出来）然而我并不知道怎么办…就在一筹莫展之际，我看到了这篇文章<a target="_blank" rel="noopener" href="https://xz.aliyun.com/news/16929">子集和问题的两种解决方式-先知社区</a></p>
<p>跟这道题惊人的相似，那就不客气的调用了</p>
<p><img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20251013182422553.png" alt="image-20251013182422553"></p>
<p>类似这种，将g和h填入后适当改变BKZ格数为30，通过sagemath求解，代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">list</span> = [[<span class="number">231505343357840297578551618297641</span>, <span class="number">162478315971265520003006061224519</span>, <span class="number">249122267759965979062997582843579</span>, <span class="number">242148256018119929891162688012593</span>, <span class="number">236154532367469508193772561248719</span>, <span class="number">308006971480580625373966414567847</span>, <span class="number">315669011913230351590594855993211</span>, <span class="number">293670447806601651578170627275713</span>, <span class="number">262549466366061541610902057313057</span>, <span class="number">166722242774241137724892121051911</span>, <span class="number">215597111132328547317464043485129</span>, <span class="number">316412354287520073122496624861503</span>, <span class="number">323092663032926839669974327432017</span>, <span class="number">271177524371641474953201580067593</span>, <span class="number">167159439383524350637227292850447</span>, <span class="number">304811773531242915786868630889273</span>, <span class="number">181239202729017592152327906425071</span>, <span class="number">276158262574671082941553357526599</span>, <span class="number">268456558382861764066634485616329</span>, <span class="number">302623113721036144967247139139321</span>, <span class="number">167139516647620728080788812259307</span>, <span class="number">317796753905955984410934217520701</span>, <span class="number">299444281760353575430416431184397</span>, <span class="number">298250042408079829351747306169659</span>, <span class="number">246003993948544308143795488470553</span>, <span class="number">304348522512067623735190696338839</span>, <span class="number">310675616062989366227716038394207</span>, <span class="number">296428389874164163762469417832779</span>, <span class="number">162829316706492961028567093044271</span>, <span class="number">253804753178504060406598632504517</span>, <span class="number">309144770152162938647076061502251</span>, <span class="number">319744891855280410958715623337253</span>, <span class="number">301151130184434016052124607282657</span>, <span class="number">223607476658281102744680948884527</span>, <span class="number">312543041820328060498089533386357</span>, <span class="number">317791626421943750263219702526573</span>, <span class="number">297922735348269000411590468661637</span>, <span class="number">182502432682267747293541984059853</span>, <span class="number">279854430809423192220412675539187</span>, <span class="number">219329276902189283343004718897993</span>, <span class="number">263210495595260946139425899948113</span>, <span class="number">214979382094100759670343386546967</span>, <span class="number">178555117832802450711482731065127</span>, <span class="number">230960100893722710027517428843251</span>, <span class="number">164106342835284877868338346330701</span>, <span class="number">224144359885890197126329952883829</span>, <span class="number">229554701043363725170128843050813</span>, <span class="number">193837581190766776893379155144059</span>, <span class="number">299447082435237609682597520501959</span>, <span class="number">198460114729475319627058658874509</span>, <span class="number">274543550499638383857633881950351</span>, <span class="number">299681488432433847233408772942527</span>, <span class="number">297168095874269304991629565535417</span>, <span class="number">193578452233385681236902425076673</span>, <span class="number">258380842511309416206774786227539</span>, <span class="number">246085422056193746277482503854847</span>, <span class="number">202357457103702420446453315166773</span>, <span class="number">310384586030123578910471530985987</span>, <span class="number">302484132917338405435214633365609</span>, <span class="number">282761938556020220277280373891777</span>, <span class="number">218212238193415079796451559814113</span>, <span class="number">304044012057526779054029660871137</span>, <span class="number">173212551070522861038735875768269</span>, <span class="number">165359229770437357985792629147349</span>, <span class="number">241548333619771753020556627032907</span>, <span class="number">288343171201309906205390604511349</span>, <span class="number">245500744893578248811987359174547</span>, <span class="number">193886349752094128793096214609361</span>, <span class="number">201666495117008137775685340186997</span>, <span class="number">184304750679062818625256305065843</span>, <span class="number">288579894797101179446562374983027</span>, <span class="number">183125631435676688494720819786163</span>]]</span><br><span class="line">S=[<span class="number">9098341848667333203026424005687148</span>]</span><br><span class="line">n = <span class="built_in">len</span>(<span class="built_in">list</span>[<span class="number">0</span>])  <span class="comment"># 确定列数</span></span><br><span class="line">N=<span class="built_in">len</span>(S)</span><br><span class="line">L = matrix(QQ, n + <span class="number">1</span>, n + N)  </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i, a <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="built_in">list</span>):</span><br><span class="line">    <span class="keyword">for</span> row, x <span class="keyword">in</span> <span class="built_in">enumerate</span>(a):</span><br><span class="line">        L[row, row] = <span class="number">2</span>  </span><br><span class="line">        L[row, -(i + <span class="number">1</span>)] = x  </span><br><span class="line"></span><br><span class="line">L[-<span class="number">1</span>, :] = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">    L[-<span class="number">1</span>, -i-<span class="number">1</span>] =  S[i]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;原始矩阵:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(L)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">res = L.BKZ(block_size=<span class="number">30</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;LLL 规约后的矩阵:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line">l=res[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(l)</span><br><span class="line">a=<span class="number">0</span></span><br><span class="line">p=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span>  i <span class="keyword">in</span> l:</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="keyword">if</span> i==-<span class="number">1</span>:</span><br><span class="line">       p=(<span class="number">1</span>&lt;&lt;a)+p</span><br><span class="line">    <span class="keyword">if</span> i==<span class="number">1</span>:</span><br><span class="line">        p=p+<span class="number">0</span></span><br><span class="line">    a=a+<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(p)</span><br></pre></td></tr></table></figure>

<p>解出q&#x3D;1782971501244125564648</p>
<p>找到p后继续往下看：a &#x3D; (b * m - c) % p  有点眼熟，回到文章看看<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20251013200450796.png" alt="image-20251013200450796"></p>
<p>方法知道了，可是只知道p和a，b怎么办？</p>
<p>注意到还有gift没用到，标准AES加密，直接用库里的AES解密就行，代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">q = <span class="number">1782971501244125564648</span></span><br><span class="line">ciphertext = <span class="string">b&#x27;\xbb4Q\x9c[\xad&lt;c\x82\xf6yU\x83\xcf\xca\xbb.5\x9a\x88\x1d&#125;\x9e#)&#125;G\xc2n\xd53\\c\xd6@P\x10F\xbc7\xb4:\x8c+xZ)\xa6a\x8d\x03e9\x01\\\x18m\x88hA\xf08\xc5sKV\xa4\xd1\xe3OJ\xa4\xf8\xf8Q\xb6\x0ew\xbd\xa3\x00\x0f$6\n\x05m\xbd\x1fB\xea=\x94i\xbc\x19y\x9b\xfd\x16\xee\x15\xbc:\xec\xdd\xef\xf0\xa2\xcd7\x86&quot;\x0c\xce5; k\xaf\t\x1a\xc0R\xadl\x8b\x9a*\xd2D\x99\x9c\xc8\x06y\xf2\xb9\xa3vvZ\xad\xf0@\xfd\x9f\x10\xa4\xeb\\*\xe1\xb4\x1c\xec\xc1\x1a\xdc\xd1\xf22\xc2*\xc0tz\x84\x82\x9d\x1a\xb1\xbc\xd9\xaa;\x1dkd\xb7\x03hZ\xbe\xc7\xe7\x80\xf0\xc2\x89\xa48\xac\xf8P\xear\xaf\xf4d\xee\xeb3\\\xc8.\xae\xeb\\N\xdb\xa2\x08\xce\xbc\x9b\xbe\xbbD\xaef\xfe\x84\x96o\x95\xa8\x00-\xecS\x9d\xd56\xbe\xac\xd1H8F\xe7ZBYY\x0fxm?\xcb\xcc\xcc\xe1x\x83\xa6I\xc516c\xb50#\x99\xcb\x9dl\xd9\xe3\xaa\x06\xb0\xad\xaa\xd4\xdb\x1e3@\x0b\x0b\xe9G\xa4?\xd1\x9f\x08q\xe3\xcfF\x9f\xd2y\xb9\x98\xbb\x12=\xb9`\x86&#x27;</span></span><br><span class="line"></span><br><span class="line">key = hashlib.sha256(<span class="built_in">str</span>(q).encode()).digest()</span><br><span class="line"></span><br><span class="line">cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">gift = cipher.decrypt(ciphertext)</span><br><span class="line"><span class="built_in">print</span>( gift.decode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line"></span><br><span class="line">输出b&gt;&gt;<span class="number">50</span>=<span class="number">105587184664204945501739832131796105510727279629137767114602950976379268646309566209479215750845127573841205553374988033708466583248575645536741331275167063722164294899758660287714810637437742775193944198118923131520604836375847391414682985915364876068621414136660214571656625501591493848375171</span>（省略掉无意义字符）</span><br><span class="line"></span><br><span class="line">这是对b的提示，又已知b为<span class="number">1024</span>位质数，直接用最朴素的枚举法，代码：</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> isPrime</span><br><span class="line">X = <span class="number">105587184664204945501739832131796105510727279629137767114602950976379268646309566209479215750845127573841205553374988033708466583248575645536741331275167063722164294899758660287714810637437742775193944198118923131520604836375847391414682985915364876068621414136660214571656625501591493848375171</span></span><br><span class="line">b = X &lt;&lt; <span class="number">50</span></span><br><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">10000</span>):  </span><br><span class="line">    candidate = b + r</span><br><span class="line">    <span class="comment"># 筛选1024位+质数</span></span><br><span class="line">    <span class="keyword">if</span> candidate.bit_length() == <span class="number">1024</span> <span class="keyword">and</span> isPrime(candidate):</span><br><span class="line">        b = candidate</span><br><span class="line">        <span class="built_in">print</span>(b)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出118880601377203285595635027832103039115916487735952990125603935608803223752749292705981377240526463248785946168251948998110533274399275440186954189173776584703487161646019521866238279617774359270003381472636362966596034107113130088310498813205314474245310913058498857205657201559746658180938214194127206088767</p>
<p>现在我什么都不缺了！！</p>
<p>用文章中说的代码构造矩阵LLL算一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a = <span class="number">91079662734774583668559310267358886600859245394384191745027540062438308648253591205995812543857822566345552761453790088629048306106767325862509810756532189345719409170566606855160251701281482785914762698048687381656898628442021123830585413636176890410478947154905952847160593094188611391630396915118014450400</span></span><br><span class="line">p = <span class="number">177910185078561245847075351862481456650738829527176969180370011116483167993253282633037360384322983747926120112614710525370362977045120823936058986354452827391146807153221092149381821880333343626207562760823332692880108489939567981202911559907290951149883739493128091571315192328762037406889446590521658255337</span></span><br><span class="line">b=<span class="number">118880601377203285595635027832103039115916487735952990125603935608803223752749292705981377240526463248785946168251948998110533274399275440186954189173776584703487161646019521866238279617774359270003381472636362966596034107113130088310498813205314474245310913058498857205657201559746658180938214194127206088767</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">M = matrix([[<span class="number">2</span>^<span class="number">377</span>,<span class="number">0</span>, -a], [<span class="number">0</span>,<span class="number">1</span>, b],[<span class="number">0</span>,<span class="number">0</span>,-p]])</span><br><span class="line">L = M.LLL()[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(L[<span class="number">1</span>]))</span><br></pre></td></tr></table></figure>

<p>实际要在sagemath里运行得到flag</p>
<p><em>TSCTF-J{B@g_lattice_waiting_especially_for_u!}</em></p>
<h2 id="Web-EZ-SQL"><a href="#Web-EZ-SQL" class="headerlink" title="Web-EZ_SQL"></a>Web-EZ_SQL</h2><p>（其实我没有web基础，只是想试一下，是用ai做的，原理感觉应该懂力）</p>
<p>刚开始以为题很简单，直接枚举试，到334，出现<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20251013201758542.png" alt="image-20251013201758542"></p>
<p>但是这是不对的。</p>
<p>仔细想想决定用常规方法做，先尝试用1’ #，发现#成功将后面内容注释掉了，说明可以注入代码了</p>
<p>原表中有3列，可以尝试构造payload：1’ union select 1,flag,’flag_placeholder’ from flag #</p>
<p>输入后报错<img src="C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20251013202252905.png" alt="image-20251013202252905"></p>
<p>可以尝试报错注入找到flag</p>
<p>使用替换函数1’ and updatexml(1, concat(0x7e, (select flag from flag), 0x7e), 1) #</p>
<p>在报错信息找到flag：<em>TSCTF-J{sql_1nj3ct10n_m4573r}</em></p>

    </div>
    
    
    
    
    
    
    
</div>

            <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2022 - 2025 Hexo
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;John Doe
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/theme-particlex/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

        </div>
        
        <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
        </transition>
        
    </div>
    <script src="/js/main.js"></script>
    
    




    
</body>
</html>
